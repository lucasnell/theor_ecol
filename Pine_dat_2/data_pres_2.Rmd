---
title: "Data Presentation 2"
subtitle: "Zero-inflated CPUE"
author: "Lucas A. Nell"
date: "10/12/2016"
output:
    ioslides_presentation:
        transition: faster
        smaller: true
        widescreen: true
runtime: shiny
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, eval = TRUE)
library(magrittr)
library(purrr)
library(dplyr)
library(readr)
library(tidyr)
library(ggplot2)
library(grid)
```

```{r input_data, include = FALSE}
if (grepl('theor_ecol$', getwd())){
    setwd('./Pine_dat_2')
} else if (!grepl('Pine_dat_2$', getwd())) {
    stop('Unknown directory. It should be in one ending in "theor_ecol" or "Pine_dat_2".')
}
catch_df <- read_csv('catch by station.csv')
disch_df <- read_csv('ABQ_discharge.csv')
```

```{r gg_theme, include = FALSE}
# Custom ggplot2 theme
theme_lan <- function(base_size = 10, base_family = 'Helvetica') {
    theme_classic(base_size = base_size, base_family = base_family) %+replace%
        theme(
            strip.text = element_text(face = 'bold'),
            panel.border = element_rect(fill = NA, color = "gray50"),
            legend.position = 'none'
        )
}
```


## Sampling design

```{r sein_pic, fig.align = 'center', out.width = "800px"}
seine_pic <- "https://www.army.mil/e2/c/images/2014/08/18/359126/original.jpg"
knitr::include_graphics(seine_pic)
```


## Sampling effort

```{r area_hist, fig.align = 'center', fig.height = 4, fig.width = 8}
p <- catch_df %>% 
    ggplot(aes(Area)) +
    theme_lan() +
    geom_histogram(bins = 30, fill = 'dodgerblue3') + 
    xlab(expression('Area surveyed (' * m^2 * ')'))

p_trans <- p + scale_x_continuous(trans = 'log', breaks = seq(2e3, 6e3, 2e3),
                                  labels = scales::comma) + 
    ggtitle('log transformed')
p <- p + scale_x_continuous(labels = scales::comma, breaks = seq(2e3, 6e3, 2e3)) +
    ggtitle('untransformed')

grid.newpage()
grid.draw(cbind(ggplotGrob(p),
                ggplotGrob(p_trans),
                size = 'last'))
```


#### *Does sampling error increase/decrease with sampling area??*


## Sampling effort (cont.)

```{r locations_line, fig.align = 'center', fig.height = 4, fig.width = 8}
catch_df %>%
    group_by(Year) %>%
    summarize(stations = n()) %>% 
    mutate(Date = paste(Year, '01', '01', sep = '-') %>% as.Date(format = '%Y-%m-%d')) %>% 
    ggplot(aes(Date, stations)) +
    theme_lan() +
    geom_line(linetype = 1, color = 'dodgerblue3') +
    geom_point(size = 2) +
    scale_x_date() +
    ylab('Number of locations surveyed')
```

## Count data

#### *A schooling species of minnow*

```{r count_summ, fig.height = 4, fig.width = 8}
p <- catch_df %>% 
    ggplot(aes(Count/(Area / 100))) +
    theme_lan() +
    geom_histogram(bins = 30, fill = 'dodgerblue3') + 
    xlab(expression('Minnow counts per' ~ 100 * m^2 ~ 'seined'))
p_trans <- p + scale_x_continuous(trans = 'log1p', breaks = c(0, 50, 100, 200), 
                                  labels = scales::comma) +
    ggtitle('log1p transformed')
p <- p + ggtitle('untransformed')

grid.newpage()
grid.draw(cbind(ggplotGrob(p),
                ggplotGrob(p_trans),
                size = 'last'))
```





